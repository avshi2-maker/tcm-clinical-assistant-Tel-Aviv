<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yin-Yang Assessment - ×”×¢×¨×›×ª ×™×™×Ÿ-×™×× ×’</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Heebo', sans-serif; 
        }
        .section-card { 
            transition: all 0.3s ease; 
            border-right: 4px solid transparent; 
        }
        .section-card.active { 
            border-color: #667eea; 
            background: #f0f4ff; 
        }
        .section-card.completed {
            border-color: #10b981;
            background: #f0fdf4;
        }
        .option-card { 
            transition: all 0.2s ease; 
            cursor: pointer; 
            border: 2px solid #e5e7eb; 
        }
        .option-card:hover { 
            border-color: #667eea; 
            background: #f9fafb; 
            transform: translateX(-2px);
        }
        .option-card.selected { 
            border-color: #667eea; 
            background: #eff6ff; 
            box-shadow: 0 4px 6px -1px rgba(102, 126, 234, 0.1);
        }
        .progress-bar { 
            transition: width 0.5s ease; 
            background: linear-gradient(90deg, #667eea, #764ba2);
        }
        .pattern-badge { 
            padding: 10px 20px; 
            border-radius: 25px; 
            font-weight: 600; 
            display: inline-block; 
            margin: 6px; 
            font-size: 1rem;
        }
        .yin-def { background: #fecaca; color: #991b1b; }
        .yang-def { background: #dbeafe; color: #1e40af; }
        .balanced { background: #d1fae5; color: #065f46; }
        .yin-yang-excess { background: #fed7aa; color: #9a3412; }
        .yang-yin-excess { background: #e0e7ff; color: #3730a3; }
        .result-card { 
            animation: fadeIn 0.6s ease; 
        }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .yin-yang-symbol {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: #1e3a8a;
            position: relative;
            margin: 0 auto;
            box-shadow: 0 15px 35px rgba(0,0,0,0.25);
        }
        .yin-yang-symbol::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            background: #dc2626;
            border-radius: 100% 0 0 100%;
        }
        .yin-yang-symbol::after {
            content: '';
            position: absolute;
            top: 25%;
            left: 25%;
            width: 50%;
            height: 50%;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 0 20px #1e3a8a, 0 50px 0 0 #dc2626;
        }
        .dimension-bar {
            height: 28px;
            border-radius: 14px;
            background: #e5e7eb;
            overflow: hidden;
            position: relative;
        }
        .dimension-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
        }
        .yin-color { background: linear-gradient(90deg, #1e40af, #3b82f6); }
        .yang-color { background: linear-gradient(90deg, #dc2626, #ef4444); }
        .qi-color { background: linear-gradient(90deg, #059669, #10b981); }
        .heat-color { background: linear-gradient(90deg, #ea580c, #f97316); }
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
        }
        .print-only { display: none; }
        .safety-flag {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin-top: 8px;
            border-radius: 4px;
        }
        /* Question styling */
        .question-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; padding: 12px; background: #f9fafb; border-radius: 8px; flex-wrap: wrap; gap: 12px; }
        .question-left { display: flex; align-items: center; gap: 12px; flex: 1; }
        .question-number { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: bold; font-size: 13px; padding: 4px 12px; border-radius: 16px; white-space: nowrap; }
        .question-status { display: flex; align-items: center; gap: 6px; font-size: 13px; font-weight: 600; }
        .status-check { width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; }
        .status-check.answered { background: #10b981; color: white; }
        .status-check.unanswered { background: #fee2e2; color: #ef4444; }
        .status-text.answered { color: #10b981; }
        .status-text.unanswered { color: #ef4444; }
        .missing-alert { background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 16px; margin-top: 12px; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 shadow-lg no-print">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-4xl font-bold mb-2 text-right">â˜¯ï¸ ×”×¢×¨×›×ª ××™×–×•×Ÿ ×™×™×Ÿ-×™×× ×’</h1>
            <p class="text-purple-100 text-right text-lg">×©××œ×•×Ÿ ××§×™×£ ×œ×–×™×”×•×™ ×“×¤×•×¡×™ ×™×™×Ÿ-×™×× ×’ ×‘×¨×¤×•××” ×”×¡×™× ×™×ª</p>
            <p class="text-sm text-purple-200 text-right mt-2">TCM Clinical Assistant - Tel Aviv | ×’×¨×¡×” 1.0.0</p>
        </div>
    </div>

    <div class="max-w-6xl mx-auto p-6">
        <!-- Progress Bar -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6 no-print">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-semibold text-gray-600">×”×ª×§×“××•×ª ×”×©××œ×•×Ÿ</span>
                <span class="text-sm font-semibold text-purple-600" id="progress-text">0%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-4">
                <div class="progress-bar h-4 rounded-full" id="progress-bar" style="width: 0%"></div>
            </div>
            <p class="text-xs text-gray-500 mt-2 text-right" id="questions-answered">0 ××ª×•×š 11 ×©××œ×•×ª × ×¢× ×•</p>
            <div id="missing-alert" class="missing-alert" style="display: none;">
                <div class="flex items-start gap-3">
                    <svg class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    <div class="flex-1">
                        <p class="font-bold text-gray-800 text-right mb-1">× ×•×ª×¨×• ×©××œ×•×ª:</p>
                        <p id="missing-list" class="text-gray-700 text-right text-sm"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Real-time Scores Display -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6" id="live-scores" style="display: none;">
            <h3 class="text-xl font-bold text-gray-800 mb-4 text-right flex items-center justify-end gap-2">
                <span>× ×™×§×•×“ ×‘×–××Ÿ ×××ª</span>
                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
            </h3>
            <div class="space-y-4">
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">×—×¡×¨ ×™×™×Ÿ (Yin Deficiency)</span>
                        <span class="text-lg font-bold text-blue-900" id="score-yin-def">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill yin-color" id="bar-yin-def" style="width: 0%">
                            <span id="bar-text-yin-def"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">×—×¡×¨ ×™×× ×’ (Yang Deficiency)</span>
                        <span class="text-lg font-bold text-red-700" id="score-yang-def">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill yang-color" id="bar-yang-def" style="width: 0%">
                            <span id="bar-text-yang-def"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">××™×–×•×Ÿ ×™×™×Ÿ (Yin Balance)</span>
                        <span class="text-lg font-bold text-green-700" id="score-yin-bal">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill qi-color" id="bar-yin-bal" style="width: 0%">
                            <span id="bar-text-yin-bal"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">××™×–×•×Ÿ ×™×× ×’ (Yang Balance)</span>
                        <span class="text-lg font-bold text-green-700" id="score-yang-bal">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill qi-color" id="bar-yang-bal" style="width: 0%">
                            <span id="bar-text-yang-bal"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">×¢×•×“×£ ×™×× ×’ (Yang Excess)</span>
                        <span class="text-lg font-bold text-orange-600" id="score-yang-excess">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill heat-color" id="bar-yang-excess" style="width: 0%">
                            <span id="bar-text-yang-excess"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">×—×¡×¨ ×¦'×™ (Qi Deficiency)</span>
                        <span class="text-lg font-bold text-emerald-700" id="score-qi-def">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill qi-color" id="bar-qi-def" style="width: 0%">
                            <span id="bar-text-qi-def"></span>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-semibold text-gray-700">×—×•× (Heat)</span>
                        <span class="text-lg font-bold text-orange-700" id="score-heat">0</span>
                    </div>
                    <div class="dimension-bar">
                        <div class="dimension-fill heat-color" id="bar-heat" style="width: 0%">
                            <span id="bar-text-heat"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg p-8 mb-6 text-center" id="submit-section" style="display: none;">
            <button onclick="showResults()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-16 py-5 rounded-xl font-bold text-2xl hover:from-purple-700 hover:to-pink-700 transition shadow-2xl transform hover:scale-105">
                âœ¨ ×”×¦×’ ×ª×•×¦××•×ª ××œ××•×ª âœ¨
            </button>
            <p class="text-gray-600 mt-4 text-lg font-semibold">ğŸ‰ ×›×œ ×”×©××œ×•×ª × ×¢× ×•!</p>
        </div>

        <!-- Questionnaire Sections -->
        <div id="questionnaire">
            <!-- Section 1: General State -->
            <div class="section-card bg-white rounded-lg shadow-md p-6 mb-6 active" data-section="general">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-right border-b-2 border-purple-200 pb-3">
                    ××¦×‘ ×›×œ×œ×™
                </h2>
                
                <!-- Question 1: Energy Level -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 1/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-energy_level">âœ—</span>
                            <span class="status-text unanswered" id="status-energy_level">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×›×™×¦×“ ×”×× ×¨×’×™×” ×”×›×œ×œ×™×ª ×©×œ×š ×‘××”×œ×š ×”×™×•×?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="energy_level" data-option="very_low">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">× ××•×›×” ×××•×“, ××•×ª×©/×ª</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="energy_level" data-option="low">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">× ××•×›×” ×œ××“×™</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="energy_level" data-option="balanced">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×™×¦×™×‘×”, ×××•×–× ×ª</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="energy_level" data-option="high_agitated">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×’×‘×•×”×” ×¢× ×—×•×¡×¨ ×× ×•×—×” ××• ×ª×¡×™×¡×”</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 2: Temperature Preference -->
                <div class="mb-6">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 2/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-temperature_preference">âœ—</span>
                            <span class="status-text unanswered" id="status-temperature_preference">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×”×× ××ª/×” ×‘×“×¨×š ×›×œ×œ ××¨×’×™×©/×” ×™×•×ª×¨ ×§×¨ ××• ×—× ×‘×”×©×•×•××” ×œ×× ×©×™× ××—×¨×™×?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="temperature_preference" data-option="very_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×¢×ª×™× ×§×¨×•×‘×•×ª ××¨×’×™×©/×” ×§×¨, ×œ× ××•×”×‘/×ª ×§×•×¨</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="temperature_preference" data-option="slightly_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">××¢×˜ ×™×•×ª×¨ ×§×¨ ×××—×¨×™×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="temperature_preference" data-option="neutral">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×‘×¢×¨×š ×›××• ××—×¨×™×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="temperature_preference" data-option="hot">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×¢×ª×™× ×§×¨×•×‘×•×ª ××¨×’×™×©/×” ×—×, ×œ× ××•×”×‘/×ª ×—×•×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="temperature_preference" data-option="evening_hot">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×™×•×ª×¨ ×—×•× ×‘×¢×¨×‘ ××• ×‘×œ×™×œ×”</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Heat, Cold & Sweat -->
            <div class="section-card bg-white rounded-lg shadow-md p-6 mb-6" data-section="heat_cold_sweat">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-right border-b-2 border-purple-200 pb-3">
                    ×—×•×, ×§×•×¨ ×•×”×–×¢×”
                </h2>
                
                <!-- Question 3: Cold Sensitivity -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 3/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-cold_sensitivity">âœ—</span>
                            <span class="status-text unanswered" id="status-cold_sensitivity">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×”×× ×™×© ×œ×š ×™×“×™×™×/×¨×’×œ×™×™× ×§×¨×•×ª ××• ×”×¨×’×©×ª ×§×•×¨ ×‘×’×‘ ×”×ª×—×ª×•×Ÿ/×‘×˜×Ÿ?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="cold_sensitivity" data-option="none">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="cold_sensitivity" data-option="mild">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×¤×¢××™×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="cold_sensitivity" data-option="marked">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×¢×ª×™× ×§×¨×•×‘×•×ª ×•×‘××•×¤×Ÿ ×‘×¨×•×¨</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 4: Heat Sensation -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 4/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-heat_sensation">âœ—</span>
                            <span class="status-text unanswered" id="status-heat_sensation">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×”×× ××ª/×” ×—×•×•×” ×ª×—×•×©×•×ª ×©×œ ×—×•× (×›×¤×•×ª ×™×“×™×™×, ×›×¤×•×ª ×¨×’×œ×™×™×, ×—×–×”, ×¤× ×™×)?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="heat_sensation" data-option="none">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="heat_sensation" data-option="pm_heat">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×™×•×ª×¨ ××—×¨ ×”×¦×”×¨×™×™×/×¢×¨×‘</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="heat_sensation" data-option="all_day_heat">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×›×œ ×”×™×•× ××• ××ª×—××/×ª ×‘×§×œ×•×ª</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="heat_sensation" data-option="night_sweats">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×”×–×¢×•×ª ×œ×™×œ×” ×¢× ×—×•×</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 5: Sweating -->
                <div class="mb-6">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 5/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-sweating">âœ—</span>
                            <span class="status-text unanswered" id="status-sweating">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ××™×š ×”×”×–×¢×” ×©×œ×š?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="sweating" data-option="normal">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¨×’×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sweating" data-option="spontaneous">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×”×–×¢×” ×¡×¤×•× ×˜× ×™×ª ×¢× ××¢×˜ ××××¥</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sweating" data-option="night">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×”×–×¢×•×ª ×œ×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sweating" data-option="no_sweat_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×œ×œ× ×”×–×¢×”, ×’×•×£ ×§×¨</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: Thirst, Fluids, Sleep -->
            <div class="section-card bg-white rounded-lg shadow-md p-6 mb-6" data-section="fluids_sleep">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-right border-b-2 border-purple-200 pb-3">
                    ×¦××, × ×•×–×œ×™× ×•×©×™× ×”
                </h2>
                
                <!-- Question 6: Thirst -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 6/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-thirst">âœ—</span>
                            <span class="status-text unanswered" id="status-thirst">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×ª××¨/×™ ××ª ×”×¦×× ×•×¦×¨×™×›×ª ×”× ×•×–×œ×™× ×©×œ×š
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="thirst" data-option="low_thirst">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">××¢×˜ ×¦××, ××¢×“×™×£/×” ××©×§××•×ª ×—××™×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="thirst" data-option="normal">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¦×× ×¨×’×™×œ</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="thirst" data-option="high_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¦×× ×—×–×§, ××¢×“×™×£/×” ××©×§××•×ª ×§×¨×™×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="thirst" data-option="dry_mouth_little_drink">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¤×” ×™×‘×© ××š ×¨×§ ×œ×’×™××•×ª ×§×˜× ×•×ª</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 7: Sleep -->
                <div class="mb-6">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 7/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-sleep">âœ—</span>
                            <span class="status-text unanswered" id="status-sleep">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ××™×š ×”×©×™× ×” ×©×œ×š?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="sleep" data-option="good">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×™×©×Ÿ/×” ×˜×•×‘ ×œ××•×¨×š ×”×œ×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sleep" data-option="difficulty_falling">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×§×©×” ×œ×”×™×¨×“×, ××•×— ×¢×¡×•×§</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sleep" data-option="waking_night">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">××ª×¢×•×¨×¨/×ª ×œ×¢×ª×™× ×§×¨×•×‘×•×ª, ×—×•×, ×”×–×¢×•×ª ×œ×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="sleep" data-option="excessive_sleep">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¦×¨×™×š/×” ×”×¨×‘×” ×©×™× ×”, ×¢×“×™×™×Ÿ ×¢×™×™×£/×”</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 4: Stool & Urine -->
            <div class="section-card bg-white rounded-lg shadow-md p-6 mb-6" data-section="bowel_urine">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-right border-b-2 border-purple-200 pb-3">
                    ×¦×•××” ×•×©×ª×Ÿ
                </h2>
                
                <!-- Question 8: Stool -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 8/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-stool">âœ—</span>
                            <span class="status-text unanswered" id="status-stool">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ××™×š ×ª× ×•×¢×•×ª ×”××¢×™×™× ×©×œ×š?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="stool" data-option="normal">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¨×’×™×œ×•×ª, ××¢×•×¦×‘×•×ª</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="stool" data-option="loose_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¨×•×¤×¤×•×ª, ×‘××™×•×—×“ ×¢× ×§×•×¨ ××• ×‘×‘×•×§×¨</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="stool" data-option="dry_constipation">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¦×•××” ×™×‘×©×”, ×§×©×” ××• ×¢×¦×™×¨×•×ª</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 9: Urine -->
                <div class="mb-6">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 9/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-urine">âœ—</span>
                            <span class="status-text unanswered" id="status-urine">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ××™×š ×”×”×˜×œ×” ×©×œ×š?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="urine" data-option="normal">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¨×’×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="urine" data-option="frequent_clear">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×ª×›×•×¤×”, ×‘×”×™×¨×”, ×‘××™×•×—×“ ×‘×œ×™×œ×”</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="urine" data-option="dark_scanty">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×›×”×”, ××•×¢×˜×”</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 5: Body Form & Sensations -->
            <div class="section-card bg-white rounded-lg shadow-md p-6 mb-6" data-section="body_form">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-right border-b-2 border-purple-200 pb-3">
                    ××‘× ×” ×’×•×£ ×•×ª×—×•×©×•×ª
                </h2>
                
                <!-- Question 10: Body Build -->
                <div class="mb-8">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 10/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-body_build">âœ—</span>
                            <span class="status-text unanswered" id="status-body_build">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ××™×š ×”×™×™×ª ××ª××¨/×ª ××ª ××‘× ×” ×”×’×•×£ ×•×”×ª×—×•×©×” ×©×œ×š?
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="body_build" data-option="thin_dry">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¨×–×”, ×™×‘×©, × ×˜×™×™×” ×œ×™×•×‘×©</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="body_build" data-option="puffy_cold">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">× ×¤×•×—, ××¨×’×™×©/×” ×§×¨, ×›×‘×“</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="body_build" data-option="robust_red_face">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×—×¡×•×Ÿ ×¢× × ×˜×™×™×” ×œ×¤× ×™× ××“×•××•×ª ××• ×§×•×œ ×—×–×§</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="body_build" data-option="balanced">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×¤×¨×•×¤×•×¨×¦×™×•× ×œ×™, ×××•×–×Ÿ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 11: Pain (Multi-choice) -->
                <div class="mb-6">
                    <div class="question-header">
                        <div class="question-left">
                            <span class="question-number">×©××œ×” 11/11</span>
                            <label class="text-lg font-semibold text-gray-700 text-right">
                                ×©××œ×”
                            </label>
                        </div>
                        <div class="question-status">
                            <span class="status-check unanswered" id="check-pain">âœ—</span>
                            <span class="status-text unanswered" id="status-pain">×œ× × ×¢× ×ª×”</span>
                        </div>
                    </div>
                        ×›××‘×™× ×§×‘×•×¢×™× ×›×œ×©×”× (××¤×¨×§×™×, ×’×‘, ×’×¤×™×™×)? <span class="text-sm text-gray-500">(× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×™×•×ª×¨ ×××—×“)</span>
                    </label>
                    <div class="space-y-3">
                        <div class="option-card p-4 rounded-lg" data-question="pain" data-option="cold_pain_better_warm" data-multi="true">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×›××‘ ×§×¨, ×˜×•×‘ ×™×•×ª×¨ ×¢× ×—×•×/×œ×—×¥</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="pain" data-option="burning_pain" data-multi="true">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">×ª×—×•×©×ª ×©×¨×™×¤×” ××• ×›××‘ ×—×•×</span>
                            </div>
                        </div>
                        <div class="option-card p-4 rounded-lg" data-question="pain" data-option="none" data-multi="true">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-3">
                                    <div class="w-5 h-5 rounded border-2 border-gray-300"></div>
                                </div>
                                <span class="text-gray-700">××™×Ÿ ×›××‘ ××©××¢×•×ª×™</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" style="display: none;">
            <div class="result-card bg-white rounded-lg shadow-lg p-8 mb-6">
                <div class="text-center mb-8">
                    <div class="yin-yang-symbol mb-6"></div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">×ª×•×¦××•×ª ×”×”×¢×¨×›×”</h2>
                    <p class="text-gray-600">× ×™×ª×•×— ××§×™×£ ×©×œ ××™×–×•×Ÿ ×”×™×™×Ÿ-×™×× ×’ ×©×œ×š</p>
                </div>

                <!-- Primary Pattern -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4 text-right">×“×¤×•×¡ ×¨××©×™:</h3>
                    <div class="text-center mb-4">
                        <span id="primary-pattern-badge" class="pattern-badge text-xl"></span>
                    </div>
                    <div class="bg-blue-50 border-r-4 border-blue-500 p-6 rounded-lg">
                        <h4 class="font-bold text-lg text-gray-800 mb-3 text-right">×”×¡×‘×¨ ×œ××˜×•×¤×œ:</h4>
                        <p id="patient-explanation" class="text-gray-700 text-right leading-relaxed text-lg"></p>
                    </div>
                </div>

                <!-- Typical Signs -->
                <div class="mb-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-right">×¡×™×× ×™× ××•×¤×™×™× ×™×™×:</h3>
                    <ul id="typical-signs" class="space-y-2 text-right"></ul>
                </div>

                <!-- TCM Notes -->
                <div class="mb-8 bg-purple-50 border-r-4 border-purple-500 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-3 text-right">×”×¢×¨×•×ª TCM ×œ××˜×¤×œ:</h3>
                    <p id="tcm-notes" class="text-gray-700 text-right leading-relaxed"></p>
                </div>

                <!-- Safety Flags -->
                <div id="safety-flags-section" style="display: none;" class="mb-8">
                    <h3 class="text-xl font-bold text-red-700 mb-4 text-right flex items-center justify-end gap-2">
                        <span>×“×’×œ×™ ×‘×˜×™×—×•×ª - × ×“×¨×© ×ª×©×•××ª ×œ×‘:</span>
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </h3>
                    <ul id="safety-flags" class="space-y-2 text-right"></ul>
                </div>

                <!-- Follow-up Questions -->
                <div id="followup-section" class="mb-8 bg-green-50 border-r-4 border-green-500 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-right">×©××œ×•×ª ×”××©×š ××•××œ×¦×•×ª:</h3>
                    <ul id="followup-questions" class="space-y-2 text-right"></ul>
                </div>

                <!-- Lifestyle Prompts -->
                <div id="lifestyle-section" class="mb-8 bg-yellow-50 border-r-4 border-yellow-500 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 text-right">×©××œ×•×ª ××•×¨×— ×—×™×™×:</h3>
                    <ul id="lifestyle-prompts" class="space-y-2 text-right"></ul>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4 justify-center mt-8 no-print">
                    <button onclick="window.print()" class="print-button text-white px-8 py-3 rounded-lg font-semibold hover:opacity-90 transition" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        ğŸ–¨ï¸ ×”×“×¤×¡ ×ª×•×¦××•×ª
                    </button>
                    <button onclick="resetAssessment()" class="bg-gray-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-700 transition">
                        ğŸ”„ ×”×ª×—×œ ××—×“×©
                    </button>
                </div>

                <!-- Print-only Timestamp -->
                <div class="print-only mt-8 text-center text-sm text-gray-600">
                    <p>×ª××¨×™×š ×”×”×¢×¨×›×”: <span id="assessment-date"></span></p>
                    <p>TCM Clinical Assistant - Tel Aviv</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Structure from the document
        const questionData = {
            energy_level: {
                very_low: { yang_def: 2 },
                low: { yang_def: 1 },
                balanced: { yin_bal: 1, yang_bal: 1 },
                high_agitated: { yang_excess: 2 }
            },
            temperature_preference: {
                very_cold: { yang_def: 2 },
                slightly_cold: { yang_def: 1 },
                neutral: { yin_bal: 1, yang_bal: 1 },
                hot: { yin_def: 2, yang_excess: 1 },
                evening_hot: { yin_def: 2 }
            },
            cold_sensitivity: {
                none: {},
                mild: { yang_def: 1 },
                marked: { yang_def: 2 }
            },
            heat_sensation: {
                none: {},
                pm_heat: { yin_def: 2 },
                all_day_heat: { yang_excess: 2 },
                night_sweats: { yin_def: 3 }
            },
            sweating: {
                normal: {},
                spontaneous: { qi_def: 1, yang_def: 1 },
                night: { yin_def: 2 },
                no_sweat_cold: { yang_def: 2 }
            },
            thirst: {
                low_thirst: { yang_def: 1 },
                normal: {},
                high_cold: { yang_excess: 1, heat: 1 },
                dry_mouth_little_drink: { yin_def: 2 }
            },
            sleep: {
                good: { yin_bal: 1, yang_bal: 1 },
                difficulty_falling: { yang_excess: 1, yin_def: 1 },
                waking_night: { yin_def: 2 },
                excessive_sleep: { yang_def: 2 }
            },
            stool: {
                normal: {},
                loose_cold: { yang_def: 2 },
                dry_constipation: { yin_def: 2, heat: 1 }
            },
            urine: {
                normal: {},
                frequent_clear: { yang_def: 2 },
                dark_scanty: { yin_def: 1, heat: 1 }
            },
            body_build: {
                thin_dry: { yin_def: 2 },
                puffy_cold: { yang_def: 2 },
                robust_red_face: { yang_excess: 2 },
                balanced: { yin_bal: 1, yang_bal: 1 }
            },
            pain: {
                cold_pain_better_warm: { yang_def: 1 },
                burning_pain: { yin_def: 1, yang_excess: 1 },
                none: {}
            }
        };

        const patternDefinitions = {
            yin_deficiency: {
                name: "×—×¡×¨ ×™×™×Ÿ (Yin Deficiency)",
                name_en: "Yin Deficiency",
                badge_class: "yin-def",
                patient_friendly: "×”×’×•×£ ×©×œ×š ××¨××” ×¡×™×× ×™× ×©×œ ×©×™××•×© ×‘××©××‘×™ × ×•×–×œ×™× ×•×§×™×¨×•×¨ ××”×¨ ×™×•×ª×¨ ×××” ×©×”×•× ×™×›×•×œ ×œ×‘× ×•×ª ××•×ª× ××—×“×©. ×–×” ×™×›×•×œ ×œ×™×¦×•×¨ ×—×•× ×¤× ×™××™ ×•×—×•×¡×¨ ×× ×•×—×”.",
                typical_signs: [
                    "×—×•× ××—×¨ ×”×¦×”×¨×™×™× ××• ×‘×¢×¨×‘",
                    "×”×–×¢×•×ª ×œ×™×œ×”",
                    "×¤×” ××• ×’×¨×•×Ÿ ×™×‘×©×™×, ×‘××™×•×—×“ ×‘×œ×™×œ×”",
                    "×’×•×£ ×¨×–×”, × ×˜×™×™×” ×œ×™×•×‘×© ×‘×¢×•×¨ ××• ×‘×¦×•××”",
                    "×©×™× ×” ×§×œ×”, ××•×¤×¨×¢×ª"
                ],
                tcm_notes: "×”×™×™×Ÿ ××™× ×• ××–×™×Ÿ ×•××§×¨×¨ ××ª ×”××™×‘×¨×™× ××¡×¤×™×§, ××” ×©××•×‘×™×œ ×œ×”×™×¤×¨××§×˜×™×‘×™×•×ª ×™×× ×’ ×™×—×¡×™×ª. ×œ×¢×ª×™× ×§×¨×•×‘×•×ª × ×¨××” ×¢× ×¡×™×× ×™ ×—×•× ××—×¡×•×¨.",
                safety_flags: [
                    "×™×¨×™×“×” ×‘×œ×ª×™ ××•×¡×‘×¨×ª ×‘××©×§×œ",
                    "× ×“×•×“×™ ×©×™× ×” ××• ×—×¨×“×” ×—××•×¨×™×",
                    "×”×–×¢×•×ª ×œ×™×œ×” ××ª××©×›×•×ª"
                ]
            },
            yang_deficiency: {
                name: "×—×¡×¨ ×™×× ×’ (Yang Deficiency)",
                name_en: "Yang Deficiency",
                badge_class: "yang-def",
                patient_friendly: "×”×× ×¨×’×™×” ×”××—×××ª ×•×”××¤×¢×™×œ×” ×©×œ ×”×’×•×£ ×©×œ×š ×—×œ×©×” ×™×•×ª×¨, ×›×š ×©××ª×” ×¢×œ×•×œ ×œ×”×¨×’×™×© ×§×¨ ×•×¢×™×™×£ ×‘×™×ª×¨ ×§×œ×•×ª.",
                typical_signs: [
                    "×”×¨×’×©×ª ×§×•×¨, ×‘××™×•×—×“ ×‘×¨×’×œ×™×™×, ×™×“×™×™×, ×’×‘ ×ª×—×ª×•×Ÿ",
                    "×”×©×ª× ×” ×ª×›×•×¤×” ×•×‘×”×™×¨×”, ×‘××™×•×—×“ ×‘×œ×™×œ×”",
                    "×¦×•××” ×¨×•×¤×¤×” ××• ×‘×‘×•×§×¨ ××•×§×“×",
                    "×× ×¨×’×™×” × ××•×›×”, ×¦×•×¨×š ×‘×©×™× ×” ××¨×•×›×” ××š ×¢×“×™×™×Ÿ ×¢×™×™×£"
                ],
                tcm_notes: "×”×™×× ×’ ××™× ×• ××¡×¤×™×§ ×›×“×™ ×œ×—×× ×•×œ×”×¤×•×š × ×•×–×œ×™× ×•××–×•×Ÿ. ×œ×¢×ª×™× ×§×¨×•×‘×•×ª ×§×©×•×¨ ×œ×™×× ×’ ×©×œ ×”×˜×—×•×œ-×›×œ×™×•×ª.",
                safety_flags: [
                    "×¢×™×™×¤×•×ª ×—××•×¨×” ×¢× ×¡×—×¨×—×•×¨×ª ××• ×§×•×¦×¨ × ×©×™××”",
                    "×‘×¦×§×ª, ×‘××™×•×—×“ ×‘×¨×’×œ×™×™×",
                    "×”×©×ª× ×” ×ª×›×•×¤×” ×××•×“ ××• ×‘×¨×™×—×ª ×©×ª×Ÿ"
                ]
            },
            yin_yang_balance: {
                name: "××™×–×•×Ÿ ×™×—×¡×™ ×™×™×Ÿ-×™×× ×’",
                name_en: "Relative Yin-Yang Balance",
                badge_class: "balanced",
                patient_friendly: "×”×ª×©×•×‘×•×ª ×©×œ×š ××¨××•×ª ××™× ×˜×¨××§×¦×™×” ×××•×–× ×ª ×™×—×¡×™×ª ×‘×™×Ÿ ×”×™×™×Ÿ ×”××§×¨×¨-××–×™×Ÿ ×•×”×™×× ×’ ×”××—××-××¤×¢×™×œ.",
                typical_signs: [
                    "×× ×¨×’×™×” ×™×¦×™×‘×”",
                    "×”×¢×“×¤×ª ×˜××¤×¨×˜×•×¨×” × ×•×¨××œ×™×ª",
                    "×©×™× ×” ×•×¢×™×›×•×œ ×˜×•×‘×™×"
                ],
                tcm_notes: "××™×Ÿ ×“×¤×•×¡ ×™×™×Ÿ ××• ×™×× ×’ ×“×•××™× × ×˜×™. ×”××©×š ×œ×”×ª××§×“ ×‘×”×¨×’×œ×™ ××•×¨×— ×—×™×™× ×©×©×•××¨×™× ×¢×œ ××™×–×•×Ÿ.",
                safety_flags: []
            },
            yin_def_yang_excess: {
                name: "×—×¡×¨ ×™×™×Ÿ ×¢× ×¢×•×“×£ ×™×× ×’ ×™×—×¡×™",
                name_en: "Yin Deficiency with Relative Yang Excess",
                badge_class: "yin-yang-excess",
                patient_friendly: "×™×© ××¢×˜ ×—×•×¡×¨ ×‘×™×™×Ÿ ×”××§×¨×¨/××–×™×Ÿ, ×›×š ×©×¦×“ ×”×™×× ×’ × ×¨××” ×¤×¢×™×œ ×™×•×ª×¨ ××“×™ ×‘××•×¤×Ÿ ×™×—×¡×™. ×–×” ×™×›×•×œ ×œ×”×•×¤×™×¢ ×›×—×•×, ×ª×¡×™×¡×” ××• ×‘×¢×™×•×ª ×©×™× ×”.",
                typical_signs: [
                    "×¢×¦×‘× ×•×ª, ×—×•×¡×¨ ×× ×•×—×”",
                    "×¤× ×™× ××“×•××•×ª ××• ×ª×—×•×©×•×ª ×—×•× ×¢× ×™×•×‘×©",
                    "×”×–×¢×•×ª ×œ×™×œ×”, ×¦×•××” ×™×‘×©×”"
                ],
                tcm_notes: "×—×¡×¨ ×™×™×Ÿ × ×›×©×œ ×œ×¢×’×Ÿ ××ª ×”×™×× ×’; ×¢×•×“×£ ×™×× ×’ ×™×—×¡×™ ××•×¤×™×¢ ×›×—×•× ××—×¡×•×¨.",
                safety_flags: [
                    "×“×¤×™×§×•×ª ×œ×‘ ×¢× × ×“×•×“×™ ×©×™× ×”",
                    "×©×™× ×•×™ ××©×§×œ ×œ× ××•×¡×‘×¨",
                    "×œ×—×¥ ×“× ×’×‘×•×” ××ª××©×š (×”×¤× ×” ×× ×™×© ×—×©×“)"
                ]
            },
            yang_def_yin_excess: {
                name: "×—×¡×¨ ×™×× ×’ ×¢× ×“×•××™× × ×˜×™×•×ª ×™×™×Ÿ (× ×˜×™×™×” ×œ×§×•×¨-×œ×—×•×ª)",
                name_en: "Yang Deficiency with Yin Predominance",
                badge_class: "yang-yin-excess",
                patient_friendly: "×”×¤×•× ×§×¦×™×” ×”××—×××ª ×—×œ×©×” ×™×•×ª×¨, ×›×š ×©×ª×—×•×©×•×ª ×§×•×¨ ×•×œ×—×•×ª ×™×›×•×œ×•×ª ×œ×©×œ×•×˜, ×¢× ×›×‘×“×•×ª ××• ××™×˜×™×•×ª.",
                typical_signs: [
                    "×”×¨×’×©×ª ×§×•×¨, ××¢×“×™×£ ×—×•×",
                    "×›×‘×“×•×ª ×‘××™×‘×¨×™×, ×¢×™×™×¤×•×ª",
                    "×¦×•××” ×¨×•×¤×¤×”, ×‘×¦×§×ª ××¤×©×¨×™×ª"
                ],
                tcm_notes: "×™×× ×’ ×œ× ××¡×¤×™×§ × ×›×©×œ ×œ×”×¤×•×š ×•×œ×”×–×™×– × ×•×–×œ×™×, ××” ×©××•×‘×™×œ ×œ×“×•××™× × ×˜×™×•×ª ×§×•×¨-×œ×—×•×ª.",
                safety_flags: [
                    "×‘×¦×§×ª ××• × ×¤×™×—×•×ª ×‘×•×œ×˜×ª",
                    "×× ×¨×’×™×” × ××•×›×” ×××•×“ ×”××¤×¨×™×¢×” ×œ×—×™×™ ×”×™×•××™×•×"
                ]
            },
            mixed_or_undefined: {
                name: "×“×¤×•×¡ ××¢×•×¨×‘ ××• ×œ× ××•×’×“×¨",
                name_en: "Mixed or Undefined Pattern",
                badge_class: "balanced",
                patient_friendly: "×”×ª×©×•×‘×•×ª ×©×œ×š ××¨××•×ª ×ª×‘× ×™×ª ××•×¨×›×‘×ª ×©×¢×©×•×™×” ×œ×“×¨×•×© ×”×¢×¨×›×” × ×•×¡×¤×ª ×¢×œ ×™×“×™ ××˜×¤×œ.",
                typical_signs: [
                    "××’×•×•×Ÿ ×¡×™×× ×™× ×œ×œ× ×“×¤×•×¡ ×‘×¨×•×¨",
                    "×™×™×ª×›×Ÿ ×©×™×©× × ××¡×¤×¨ ×—×•×¡×¨×™ ××™×–×•×Ÿ"
                ],
                tcm_notes: "×œ× ×”×ª××™× ×œ×§×¨×™×˜×¨×™×•× ×™× ×©×œ ×“×¤×•×¡×™× ××•×’×“×¨×™×. ×“×•×¨×© ×”×¢×¨×›×” ××¤×•×¨×˜×ª ×™×•×ª×¨ ×‘××”×œ×š ×”×˜×™×¤×•×œ.",
                safety_flags: []
            }
        };

        const followUpQuestions = {
            yin_deficiency: [
                "×××– ××ª×™ ××ª/×” ××¨×’×™×©/×” ×”×–×¢×•×ª ×œ×™×œ×” ××• ×—×•× ×‘×¢×¨×‘?",
                "×”×× ××ª/×” ××¨×’×™×©/×” ×™×•×ª×¨ ×™×•×‘×© ×‘×¢×•×¨, ×‘×¢×™× ×™×™×, ×‘×’×¨×•×Ÿ ××• ×‘×¦×•××”?",
                "××™×š ×”××¦×‘ ×”×¨×’×©×™ ×©×œ×š ×›×©×™×© ×œ×š ×§×•×©×™ ×œ×”×™×¨×“×?"
            ],
            yang_deficiency: [
                "×‘××™×œ×• ×©×¢×•×ª ×‘×™×•× ××ª/×” ×”×›×™ ×§×¨/×” ××• ×¢×™×™×£/×”?",
                "×”×× ×™×© ×©×™× ×•×™×™× ×‘×ª×“×™×¨×•×ª ××• ×‘× ×¤×— ×”×”×©×ª× ×”?",
                "×”×× ××ª/×” ××¨×’×™×©/×” ×›×‘×“×•×ª ×‘××™×‘×¨×™× ××• × ×¤×™×—×•×ª?"
            ],
            yin_yang_balance: [
                "××” ×¢×•×–×¨ ×œ×š ×œ×©××•×¨ ×¢×œ ×”××™×–×•×Ÿ ×”× ×•×›×—×™?",
                "×”×× ×™×© ×ª×—×•××™× ×¡×¤×¦×™×¤×™×™× ×©×ª×¨×¦×” ×œ×©×¤×¨?"
            ],
            yin_def_yang_excess: [
                "××” ××—××™×¨ ××ª ×ª×—×•×©×•×ª ×”×—×•× ×•×”×ª×¡×™×¡×”?",
                "××™×š ×”×©×™× ×” ×©×œ×š ××•×©×¤×¢×ª ××”×¡×˜×¨×¡?",
                "×”×× ×™×© ×“×¤×•×¡×™× ×©×œ ×™×•×‘×© ×‘×’×•×£?"
            ],
            yang_def_yin_excess: [
                "×”×× ××ª/×” ×—×©/×” ×›×‘×“×•×ª ××• × ×¤×™×—×•×ª ×‘××”×œ×š ×”×™×•×?",
                "××” ×”×§×©×¨ ×‘×™×Ÿ ×§×•×¨ ×œ××–×•×Ÿ ×©××ª/×” ××•×›×œ/×ª?",
                "××™×š ×”×¢×™×›×•×œ ×©×œ×š ×‘×‘×•×§×¨?"
            ],
            mixed_or_undefined: [
                "××™×œ×• ×¡×™××¤×˜×•××™× ×”×›×™ ××˜×¨×™×“×™× ××•×ª×š?",
                "×”×× ×™×© ×“×¤×•×¡×™× ×©×œ ×©×™× ×•×™ ×‘××”×œ×š ×”×™×•×?"
            ]
        };

        const lifestylePrompts = {
            yin_deficiency: [
                "×©××œ ×¢×œ ×œ×™×œ×•×ª ×××•×—×¨×™×, ×¢×‘×•×“×ª ×™×ª×¨ ×›×¨×•× ×™×ª ×•×œ×—×¥ ××¨×•×š ×˜×•×•×—",
                "×©××œ ×¢×œ ××–×•× ×•×ª ×—×¨×™×¤×™×, ××˜×•×’× ×™×, ××œ×›×•×”×•×œ ××• ×××•×“ ×—××™× ×‘××•×¤×™×™×"
            ],
            yang_deficiency: [
                "×©××œ ×¢×œ ×—×©×™×¤×” ×œ×§×•×¨, ××–×•× ×•×ª ×’×•×œ××™×™× ××• ×—×•×œ×©×” ×¢×™×›×•×œ×™×ª ×›×¨×•× ×™×ª",
                "×©××œ ×¢×œ ××××¥ ×¤×™×–×™ ××• ×¨×’×©×™ ××¨×•×š ×˜×•×•×—"
            ],
            yin_yang_balance: [
                "×”××©×š ×¢× ×”×¨×’×œ×™ ××•×¨×— ×—×™×™× × ×•×›×—×™×™×",
                "×©×§×•×œ ×ª×–×•× ×” ×××•×–× ×ª ×•×¤×¢×™×œ×•×ª ×’×•×¤× ×™×ª ×¡×“×™×¨×”"
            ],
            yin_def_yang_excess: [
                "×©××œ ×¢×œ ×œ×—×¥, ×’×™×¨×•×™×™× ×™×ª×¨ ×•×“×¤×•×¡×™ ×©×™× ×”",
                "×‘×“×•×§ ×¦×¨×™×›×ª ×§×¤××™×Ÿ, ××œ×›×•×”×•×œ ×•××–×•× ×•×ª ××—×××™×"
            ],
            yang_def_yin_excess: [
                "×©××œ ×¢×œ ×¦×¨×™×›×ª ××–×•× ×•×ª ×§×¨×™× ××• ×’×•×œ××™×™×",
                "×‘×“×•×§ ×—×©×™×¤×” ×œ×¡×‘×™×‘×•×ª ×§×¨×•×ª ×•×œ×—×•×ª"
            ],
            mixed_or_undefined: [
                "×‘×¦×¢ ×”×¢×¨×›×” ××§×™×¤×” ×©×œ ××•×¨×— ×—×™×™×",
                "×©×§×•×œ ×œ×”×ª×™×™×¢×¥ ×¢× ××˜×¤×œ TCM ×× ×•×¡×”"
            ]
        };

        // State management
        let answers = {};
        let scores = {
            yin_def: 0,
            yang_def: 0,
            yin_bal: 0,
            yang_bal: 0,
            yang_excess: 0,
            qi_def: 0,
            heat: 0
        };

        const totalQuestions = 11;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
        });

        function setupEventListeners() {
            const options = document.querySelectorAll('.option-card');
            options.forEach(option => {
                option.addEventListener('click', function() {
                    const question = this.dataset.question;
                    const selectedOption = this.dataset.option;
                    const isMulti = this.dataset.multi === 'true';
                    
                    if (isMulti) {
                        handleMultiChoice(question, selectedOption, this);
                    } else {
                        handleSingleChoice(question, selectedOption, this);
                    }
                    
                    updateScores();
                    updateProgress();
                    updateSectionStatus();
                });
            });
        }

        function handleSingleChoice(question, option, element) {
            // Remove selection from all options in this question
            const allOptions = document.querySelectorAll(`[data-question="${question}"]`);
            allOptions.forEach(opt => {
                opt.classList.remove('selected');
                const circle = opt.querySelector('.w-5');
                circle.style.background = 'white';
            });
            
            // Select this option
            element.classList.add('selected');
            const circle = element.querySelector('.w-5');
            circle.style.background = '#667eea';
            
            // Store answer
            answers[question] = option; markAnswered(question);
        }

        function handleMultiChoice(question, option, element) {
            if (!answers[question]) {
                answers[question] = [];
            }
            
            const index = answers[question].indexOf(option);
            const checkbox = element.querySelector('.w-5');
            
            if (index > -1) {
                // Deselect
                answers[question].splice(index, 1);
                element.classList.remove('selected');
                checkbox.style.background = 'white';
            } else {
                // Select
                answers[question].push(option);
                element.classList.add('selected');
                checkbox.style.background = '#667eea';
            }
            
            if (answers[question].length === 0) {
                delete answers[question];
            }
        }

        function updateScores() {
            // Reset scores
            scores = {
                yin_def: 0,
                yang_def: 0,
                yin_bal: 0,
                yang_bal: 0,
                yang_excess: 0,
                qi_def: 0,
                heat: 0
            };
            
            // Calculate scores
            for (const [question, answer] of Object.entries(answers)) {
                if (Array.isArray(answer)) {
                    // Multi-choice
                    answer.forEach(opt => {
                        const weights = questionData[question][opt];
                        for (const [dimension, weight] of Object.entries(weights)) {
                            scores[dimension] += weight;
                        }
                    });
                } else {
                    // Single choice
                    const weights = questionData[question][answer];
                    for (const [dimension, weight] of Object.entries(weights)) {
                        scores[dimension] += weight;
                    }
                }
            }
            
            // Update UI
            updateScoreDisplay();
        }

        function updateScoreDisplay() {
            const answeredCount = Object.keys(answers).length;
            
            if (answeredCount >= 6) {
                document.getElementById('live-scores').style.display = 'block';
            }
            
            const maxScore = Math.max(...Object.values(scores));
            
            for (const [dimension, score] of Object.entries(scores)) {
                const scoreEl = document.getElementById(`score-${dimension.replace('_', '-')}`);
                const barEl = document.getElementById(`bar-${dimension.replace('_', '-')}`);
                const textEl = document.getElementById(`bar-text-${dimension.replace('_', '-')}`);
                
                if (scoreEl && barEl) {
                    scoreEl.textContent = score;
                    const percentage = maxScore > 0 ? (score / maxScore) * 100 : 0;
                    barEl.style.width = percentage + '%';
                    if (textEl && score > 0) {
                        textEl.textContent = score;
                    }
                }
            }
        }

        function markAnswered(qid) {
            const c = document.getElementById('check-' + qid);
            const s = document.getElementById('status-' + qid);
            if (c && s) {
                c.textContent = 'âœ“';
                c.classList.remove('unanswered');
                c.classList.add('answered');
                s.textContent = '× ×¢× ×ª×”';
                s.classList.remove('unanswered');
                s.classList.add('answered');
            }
        }

        function updateProgress() {
            const answered = Object.keys(answers).length;
            const pct = Math.round((answered / totalQuestions) * 100);
            document.getElementById('progress-bar').style.width = pct + '%';
            document.getElementById('progress-text').textContent = pct + '%';
            document.getElementById('questions-answered').textContent = `${answered} ××ª×•×š ${totalQuestions} ×©××œ×•×ª × ×¢× ×•`;
            
            const all = ['energy_level','temperature_preference','cold_sensitivity','heat_sensation','sweating','thirst','sleep','stool','urine','body_build','pain'];
            const names = {energy_level:'1.×× ×¨×’×™×”',temperature_preference:'2.×˜××¤×¨×˜×•×¨×”',cold_sensitivity:'3.×§×•×¨',heat_sensation:'4.×—×•×',sweating:'5.×”×–×¢×”',thirst:'6.×¦××',sleep:'7.×©×™× ×”',stool:'8.×¦×•××”',urine:'9.×”×©×ª× ×”',body_build:'10.××‘× ×”',pain:'11.×›××‘'};
            const missing = all.filter(q => !answers[q]);
            
            if (missing.length > 0 && answered > 0) {
                document.getElementById('missing-alert').style.display = 'block';
                document.getElementById('missing-list').textContent = missing.map(q => names[q]).join(' â€¢ ');
            } else {
                document.getElementById('missing-alert').style.display = 'none';
            }
            
            if (answered === totalQuestions) {
                document.getElementById('submit-section').style.display = 'block';
                document.getElementById('missing-alert').style.display = 'none';
                setTimeout(() => document.getElementById('submit-section').scrollIntoView({behavior:'smooth',block:'center'}), 300);
            } else {
                document.getElementById('submit-section').style.display = 'none';
            }
        }

        function updateSectionStatus() {
            const sections = ['general', 'heat_cold_sweat', 'fluids_sleep', 'bowel_urine', 'body_form'];
            const questionsPerSection = {
                general: ['energy_level', 'temperature_preference'],
                heat_cold_sweat: ['cold_sensitivity', 'heat_sensation', 'sweating'],
                fluids_sleep: ['thirst', 'sleep'],
                bowel_urine: ['stool', 'urine'],
                body_form: ['body_build', 'pain']
            };
            
            sections.forEach(section => {
                const sectionEl = document.querySelector(`[data-section="${section}"]`);
                const questions = questionsPerSection[section];
                const allAnswered = questions.every(q => answers[q]);
                
                if (allAnswered) {
                    sectionEl.classList.remove('active');
                    sectionEl.classList.add('completed');
                } else {
                    sectionEl.classList.add('active');
                }
            });
        }

        function classifyPattern() {
            const s = scores;
            
            // Apply pattern mapping logic from document
            if (s.yin_def >= 4 && s.yin_def >= s.yang_def) {
                return 'yin_deficiency';
            } else if (s.yang_def >= 4 && s.yang_def > s.yin_def) {
                return 'yang_deficiency';
            } else if (s.yin_bal >= 2 && s.yang_bal >= 2 && s.yin_def <= 2 && s.yang_def <= 2 && s.yang_excess <= 2) {
                return 'yin_yang_balance';
            } else if (s.yin_def >= 4 && s.yang_excess >= 2) {
                return 'yin_def_yang_excess';
            } else if (s.yang_def >= 4 && s.yin_def <= 2) {
                return 'yang_def_yin_excess';
            } else {
                return 'mixed_or_undefined';
            }
        }

        function showResults() {
            document.getElementById('questionnaire').style.display = 'none';
            document.getElementById('live-scores').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            
            const pattern = classifyPattern();
            const patternInfo = patternDefinitions[pattern];
            
            // Primary pattern badge
            const badge = document.getElementById('primary-pattern-badge');
            badge.textContent = patternInfo.name;
            badge.className = 'pattern-badge text-xl ' + patternInfo.badge_class;
            
            // Patient explanation
            document.getElementById('patient-explanation').textContent = patternInfo.patient_friendly;
            
            // Typical signs
            const signsList = document.getElementById('typical-signs');
            signsList.innerHTML = '';
            patternInfo.typical_signs.forEach(sign => {
                const li = document.createElement('li');
                li.className = 'flex items-center gap-3 text-gray-700';
                li.innerHTML = `
                    <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span>${sign}</span>
                `;
                signsList.appendChild(li);
            });
            
            // TCM notes
            document.getElementById('tcm-notes').textContent = patternInfo.tcm_notes;
            
            // Safety flags
            if (patternInfo.safety_flags && patternInfo.safety_flags.length > 0) {
                document.getElementById('safety-flags-section').style.display = 'block';
                const flagsList = document.getElementById('safety-flags');
                flagsList.innerHTML = '';
                patternInfo.safety_flags.forEach(flag => {
                    const li = document.createElement('li');
                    li.className = 'safety-flag';
                    li.innerHTML = `
                        <div class="flex items-center gap-3">
                            <svg class="w-5 h-5 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                            <span class="font-semibold text-gray-800">${flag}</span>
                        </div>
                    `;
                    flagsList.appendChild(li);
                });
            } else {
                document.getElementById('safety-flags-section').style.display = 'none';
            }
            
            // Follow-up questions
            const followups = followUpQuestions[pattern] || [];
            const followupList = document.getElementById('followup-questions');
            followupList.innerHTML = '';
            followups.forEach(q => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-3 text-gray-700';
                li.innerHTML = `
                    <svg class="w-5 h-5 text-blue-600 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>${q}</span>
                `;
                followupList.appendChild(li);
            });
            
            // Lifestyle prompts
            const lifestyles = lifestylePrompts[pattern] || [];
            const lifestyleList = document.getElementById('lifestyle-prompts');
            lifestyleList.innerHTML = '';
            lifestyles.forEach(prompt => {
                const li = document.createElement('li');
                li.className = 'flex items-start gap-3 text-gray-700';
                li.innerHTML = `
                    <svg class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                    <span>${prompt}</span>
                `;
                lifestyleList.appendChild(li);
            });
            
            // Set timestamp
            document.getElementById('assessment-date').textContent = new Date().toLocaleString('he-IL');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function resetAssessment() {
            if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×ª×—×™×œ ××—×“×©? ×›×œ ×”×ª×©×•×‘×•×ª ×™××‘×“×•.')) {
                answers = {};
                scores = {
                    yin_def: 0,
                    yang_def: 0,
                    yin_bal: 0,
                    yang_bal: 0,
                    yang_excess: 0,
                    qi_def: 0,
                    heat: 0
                };
                
                // Reset UI
                document.querySelectorAll('.option-card').forEach(card => {
                    card.classList.remove('selected');
                    const marker = card.querySelector('.w-5');
                    marker.style.background = 'white';
                });
                
                document.querySelectorAll('.section-card').forEach(section => {
                    section.classList.remove('completed', 'active');
                });
                
                document.querySelector('[data-section="general"]').classList.add('active');
                
                document.getElementById('questionnaire').style.display = 'block';
                document.getElementById('results').style.display = 'none';
                document.getElementById('live-scores').style.display = 'none';
                
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
    </script>
</body>
</html>